d.res.sd <- sapply(d.sd,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
mean = dane.mean.WIG20)
d.sd.result <- c()
for(i in 1:20) {
d.sd.result <- c(d.sd.result, mean(d.res.sd[,i]))
}
d.res.mean <- sapply(d.mean,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
sd = dane.sd.WIG20)
d.mean.result <- c()
for(i in 1:20) {
d.mean.result <- c(d.mean.result, mean(d.res.mean[,i]))
}
d.x <- seq(from = 0, to = 1, length.out = 20)
d.x <- seq(from = 0, to = 1, length.out = 20)
d.mean.result
d.res.r <- sapply(d.r,
fun.eval.loss.preprocess1,
liczba.iteracji = 1000,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
sd = dane.sd.WIG20,
T = param.T,
mean = dane.mean.WIG20)
d.res.r <- sapply(d.r,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
sd = dane.sd.WIG20,
T = param.T,
mean = dane.mean.WIG20)
d.r.result <- c()
for(i in 1:20) {
d.r.result <- c(d.r.result, mean(d.res.r[,i]))
}
d.res.sd <- sapply(d.sd,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
mean = dane.mean.WIG20)
d.sd.result <- c()
for(i in 1:20) {
d.sd.result <- c(d.sd.result, mean(d.res.sd[,i]))
}
d.res.mean <- sapply(d.mean,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
sd = dane.sd.WIG20)
d.mean.result <- c()
for(i in 1:20) {
d.mean.result <- c(d.mean.result, mean(d.res.mean[,i]))
}
d.x <- seq(from = 0, to = 1, length.out = 20)
d <- data.frame(axis.x.param = d.x, .mean = d.mean.result, .sd = d.sd.result, .rate = d.rate.result)
rysuj.analiza.wrazliwosci <- function(data, c1 = "#A600A6", c2 = "#E40045", c3 = "#530FAD") {
chart <- ggplot(data, aes(x = axis.x.param)) +
theme(axis.text.y = element_text(size=27), axis.text.x = element_text(size=27)) +
xlab("") +
ylab("") +
geom_line(aes_string(y = ".mean"), size = 15, colour = c1, alpha = .10) +
geom_line(aes_string(y = ".sd"), size = 15, colour = c2, alpha = .10) +
geom_line(aes_string(y = ".rate"), size = 15, colour = c3, alpha = .10) +
geom_line(aes_string(y = ".mean"), size = 3, colour = c1, alpha = .90) +
geom_line(aes_string(y = ".sd"), size = 3, colour = c2, alpha = .90) +
geom_line(aes_string(y = ".rate"), size = 3, colour = c3, alpha = .90)
return (chart)
}
d <- data.frame(axis.x.param = d.x, .mean = d.mean.result, .sd = d.sd.result, .rate = d.r.result)
wykres <- rysuj.analiza.wrazliwosci(d)
wykres
d.res.mean
d.r <- seq(from = 0, to = param.r, length.out = 10)
d.mean <- seq(from = 0, to = dane.mean.WIG20, length.out = 10)
d.sd <- seq(from = 0, to = dane.sd.WIG20, length.out = 10)
set.seed(5)
d.res.r <- sapply(d.r,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
sd = dane.sd.WIG20,
T = param.T,
mean = dane.mean.WIG20)
d.r.result <- c()
for(i in 1:10) {
d.r.result <- c(d.r.result, mean(d.res.r[,i]))
}
set.seed(5)
d.res.sd <- sapply(d.sd,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
mean = dane.mean.WIG20)
d.sd.result <- c()
for(i in 1:10) {
d.sd.result <- c(d.sd.result, mean(d.res.sd[,i]))
}
set.seed(5)
d.res.mean <- sapply(d.mean,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
sd = dane.sd.WIG20)
d.mean.result <- c()
for(i in 1:10) {
d.mean.result <- c(d.mean.result, mean(d.res.mean[,i]))
}
d.x <- seq(from = 0, to = 1, length.out = 10)
d <- data.frame(axis.x.param = d.x, .mean = d.mean.result, .sd = d.sd.result, .rate = d.r.result)
wykres <- rysuj.analiza.wrazliwosci(d)
wykres
ile.dysk <- 20
###########################################################################################
ile.dysk <- 20
d.r <- seq(from = 0, to = param.r, length.out = ile.dysk)
d.mean <- seq(from = 0, to = dane.mean.WIG20, length.out = ile.dysk)
d.sd <- seq(from = 0, to = dane.sd.WIG20, length.out = ile.dysk)
set.seed(7)
d.res.r <- sapply(d.r,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
sd = dane.sd.WIG20,
T = param.T,
mean = dane.mean.WIG20)
d.r.result <- c()
for(i in 1:ile.dysk) {
d.r.result <- c(d.r.result, mean(d.res.r[,i]))
}
set.seed(7)
d.res.sd <- sapply(d.sd,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
mean = dane.mean.WIG20)
d.sd.result <- c()
for(i in 1:ile.dysk) {
d.sd.result <- c(d.sd.result, mean(d.res.sd[,i]))
}
set.seed(7)
d.res.mean <- sapply(d.mean,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
sd = dane.sd.WIG20)
d.mean.result <- c()
for(i in 1:ile.dysk) {
d.mean.result <- c(d.mean.result, mean(d.res.mean[,i]))
}
d.x <- seq(from = 0, to = 1, length.out = ile.dysk)
d <- data.frame(axis.x.param = d.x, .mean = d.mean.result, .sd = d.sd.result, .rate = d.r.result)
wykres <- rysuj.analiza.wrazliwosci(d)
wykres
##############
ile.dysk <- 20
d.r <- seq(from = 0, to = param.r, length.out = ile.dysk)
d.mean <- seq(from = 0, to = dane.mean.WIG20, length.out = ile.dysk)
d.sd <- seq(from = 0, to = dane.sd.WIG20, length.out = ile.dysk)
set.seed(5)
d.res.r <- sapply(d.r,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
sd = dane.sd.WIG20,
T = param.T,
mean = dane.mean.WIG20)
d.r.result <- c()
for(i in 1:ile.dysk) {
d.r.result <- c(d.r.result, mean(d.res.r[,i]))
}
set.seed(5)
d.res.sd <- sapply(d.sd,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
mean = dane.mean.WIG20)
d.sd.result <- c()
for(i in 1:ile.dysk) {
d.sd.result <- c(d.sd.result, mean(d.res.sd[,i]))
}
set.seed(5)
d.res.mean <- sapply(d.mean,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
sd = dane.sd.WIG20)
d.mean.result <- c()
for(i in 1:ile.dysk) {
d.mean.result <- c(d.mean.result, mean(d.res.mean[,i]))
}
d.x <- seq(from = 0, to = 1, length.out = ile.dysk)
d <- data.frame(axis.x.param = d.x, .mean = d.mean.result, .sd = d.sd.result, .rate = d.r.result)
wykres <- rysuj.analiza.wrazliwosci(d)
wykres
ile.dysk <- 20
d.r <- seq(from = 0, to = param.r, length.out = ile.dysk)
d.mean <- seq(from = 0, to = dane.mean.WIG20, length.out = ile.dysk)
d.sd <- seq(from = 0, to = dane.sd.WIG20, length.out = ile.dysk)
set.seed(5)
d.res.r <- sapply(d.r,
fun.eval.loss.preprocess1,
liczba.iteracji = 1000,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
sd = dane.sd.WIG20,
T = param.T,
mean = dane.mean.WIG20)
###########################################################################################
fun.eval.loss.preprocess1 <- function(liczba.iteracji, liczba.rehedg, typ1, s, strike, r, sd, T, mean) {
set.seed(5)
return ( sapply(rep(1,liczba.iteracji),
fun.eval.loss.simple,
typ1 = typ1,
typ2 = 0,
s = s,
strike = strike,
r = r,
sd = sd,
T = T,
liczba.rehedg = liczba.rehedg,
typ2.param = mean) )
}
ile.dysk <- 20
d.r <- seq(from = 0, to = param.r, length.out = ile.dysk)
d.mean <- seq(from = 0, to = dane.mean.WIG20, length.out = ile.dysk)
d.sd <- seq(from = 0, to = dane.sd.WIG20, length.out = ile.dysk)
d.res.r <- sapply(d.r,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
sd = dane.sd.WIG20,
T = param.T,
mean = dane.mean.WIG20)
d.r.result <- c()
for(i in 1:ile.dysk) {
d.r.result <- c(d.r.result, mean(d.res.r[,i]))
}
set.seed(5)
d.res.sd <- sapply(d.sd,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
mean = dane.mean.WIG20)
d.sd.result <- c()
for(i in 1:ile.dysk) {
d.sd.result <- c(d.sd.result, mean(d.res.sd[,i]))
}
set.seed(5)
d.res.mean <- sapply(d.mean,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
sd = dane.sd.WIG20)
d.mean.result <- c()
for(i in 1:ile.dysk) {
d.mean.result <- c(d.mean.result, mean(d.res.mean[,i]))
}
d.x <- seq(from = 0, to = 1, length.out = ile.dysk)
d <- data.frame(axis.x.param = d.x, .mean = d.mean.result, .sd = d.sd.result, .rate = d.r.result)
wykres <- rysuj.analiza.wrazliwosci(d)
wykres
############ zastosowanie 'sapply' na 'fun.eval.loss.simple' dla liczby iteracji ###########
###########################################################################################
fun.eval.loss.preprocess1 <- function(liczba.iteracji, liczba.rehedg, typ1, s, strike, r, sd, T, mean) {
set.seed(666)
return ( sapply(rep(1,liczba.iteracji),
fun.eval.loss.simple,
typ1 = typ1,
typ2 = 0,
s = s,
strike = strike,
r = r,
sd = sd,
T = T,
liczba.rehedg = liczba.rehedg,
typ2.param = mean) )
}
ile.dysk <- 20
d.r <- seq(from = 0, to = param.r, length.out = ile.dysk)
d.mean <- seq(from = 0, to = dane.mean.WIG20, length.out = ile.dysk)
d.sd <- seq(from = 0, to = dane.sd.WIG20, length.out = ile.dysk)
d.res.r <- sapply(d.r,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
sd = dane.sd.WIG20,
T = param.T,
mean = dane.mean.WIG20)
d.r.result <- c()
for(i in 1:ile.dysk) {
d.r.result <- c(d.r.result, mean(d.res.r[,i]))
}
d.res.sd <- sapply(d.sd,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
mean = dane.mean.WIG20)
d.sd.result <- c()
for(i in 1:ile.dysk) {
d.sd.result <- c(d.sd.result, mean(d.res.sd[,i]))
}
d.res.mean <- sapply(d.mean,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
sd = dane.sd.WIG20)
d.mean.result <- c()
for(i in 1:ile.dysk) {
d.mean.result <- c(d.mean.result, mean(d.res.mean[,i]))
}
d.x <- seq(from = 0, to = 1, length.out = ile.dysk)
d <- data.frame(axis.x.param = d.x, .mean = d.mean.result, .sd = d.sd.result, .rate = d.r.result)
wykres <- rysuj.analiza.wrazliwosci(d)
wykres
############ zastosowanie 'sapply' na 'fun.eval.loss.simple' dla liczby iteracji ###########
###########################################################################################
fun.eval.loss.preprocess1 <- function(liczba.iteracji, liczba.rehedg, typ1, s, strike, r, sd, T, mean) {
set.seed(111)
return ( sapply(rep(1,liczba.iteracji),
fun.eval.loss.simple,
typ1 = typ1,
typ2 = 0,
s = s,
strike = strike,
r = r,
sd = sd,
T = T,
liczba.rehedg = liczba.rehedg,
typ2.param = mean) )
}
####################################################################################
ile.dysk <- 20
d.r <- seq(from = 0, to = param.r, length.out = ile.dysk)
d.mean <- seq(from = 0, to = dane.mean.WIG20, length.out = ile.dysk)
d.sd <- seq(from = 0, to = dane.sd.WIG20, length.out = ile.dysk)
d.res.r <- sapply(d.r,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
sd = dane.sd.WIG20,
T = param.T,
mean = dane.mean.WIG20)
d.r.result <- c()
for(i in 1:ile.dysk) {
d.r.result <- c(d.r.result, mean(d.res.r[,i]))
}
d.res.sd <- sapply(d.sd,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
mean = dane.mean.WIG20)
d.sd.result <- c()
for(i in 1:ile.dysk) {
d.sd.result <- c(d.sd.result, mean(d.res.sd[,i]))
}
d.res.mean <- sapply(d.mean,
fun.eval.loss.preprocess1,
liczba.iteracji = 100,
liczba.rehedg = 31,
typ1 = 0,
s = dane.s0.WIG20,
strike = 2600,
r = param.r,
T = param.T,
sd = dane.sd.WIG20)
d.mean.result <- c()
for(i in 1:ile.dysk) {
d.mean.result <- c(d.mean.result, mean(d.res.mean[,i]))
}
d.x <- seq(from = 0, to = 1, length.out = ile.dysk)
d <- data.frame(axis.x.param = d.x, .mean = d.mean.result, .sd = d.sd.result, .rate = d.r.result)
wykres <- rysuj.analiza.wrazliwosci(d)
wykres
###########################################################################################
fun.eval.loss.preprocess1 <- function(liczba.iteracji, liczba.rehedg, typ1, s, strike, r, sd, T, mean) {
set.seed(78)
return ( sapply(rep(1,liczba.iteracji),
fun.eval.loss.simple,
typ1 = typ1,
typ2 = 0,
s = s,
strike = strike,
r = r,
sd = sd,
T = T,
liczba.rehedg = liczba.rehedg,
typ2.param = mean) )
}
t1 <- dane.part.A.abstract.risk.premium
quantile(t1, probs = c(0.1))
quantile(t1, probs = c(0.2))
hist.iteration.no <- 1000
set.seed(5)
dane.part.A.abstract.risk.premium <- fun.eval.loss.abstract(hist.iteration.no, 1, hist.type, hist.strike)
t1 <- dane.part.A.abstract.risk.premium
quantile(t1, probs = c(0.2))
quantile(t1, probs = c(0.1))
dane.part.A.abstract.risk.premium <- fun.eval.loss.abstract(hist.iteration.no, 1, hist.type, hist.strike)
hist.iteration.no <- 10000
set.seed(5)
dane.part.A.abstract.risk.premium <- fun.eval.loss.abstract(hist.iteration.no, 1, hist.type, hist.strike)
t1 <- dane.part.A.abstract.risk.premium
quantile(t1, probs = c(0.1))
quantile(t1, probs = c(0.1, 0.9))
fun.eval.option(0, dane.s0.WIG20, param.r, param.T, 0, dane.sd.WIG20, 2600)
quantile(t1, probs = c(0.1, 0.9))*exp(-param.r*param.T)
quantile(t1, probs = c(0.1))*exp(-param.r*param.T)
